%!TEX root = ts.tex
\begingroup
\def\hd{\begin{tabular}{ll}
          \textbf{Document Number:} & {\larger\docno}             \\
          \textbf{Date:}            & \reldate                    \\
          \textbf{Audience:}        & LWG                         \\
          \textbf{Reply to:}        & Jonathan Wakely             \\
                                    & cxx@kayari.org
          \end{tabular}
}
\newlength{\hdwidth}
\settowidth{\hdwidth}{\hd}
\hfill\begin{minipage}{\hdwidth}\hd\end{minipage}
\endgroup

\vspace{2.5cm}
\begin{center}
\textbf{\Huge
\doctitle}
\end{center}
\vspace{2.5cm}

This paper updates the Networking TS working draft (N4771)
to use \Cpp{}20 as its base document, rather than \Cpp{}14.

The main changes proposed are:
\begin{itemize}
\item Conform to current LWG conventions
  such as using the \mandates and \constraints elements.
\item Replace type requirements like \tcode{MoveConstructible} with
  \oldconcept{MoveConstructible} and use preferred terminology (``meets'').
\item Use consistent formatting for type requirements, to distinguish them
  from template parameters and other identifiers.
\item Remove redundant \tcode{operator==} and \tcode{operator!=} overloads
  which can be synthesized by the compiler.
  Replace \tcode{operator<} etc. with \tcode{operator<=>}.
\item Use \tcode{_v} variable templates for traits.
\item Remove reference to Library Fundamentals TS, as \tcode{string_view}
  is in the IS now.
\end{itemize}

The changes are presented as \added{additions} and \removed{removals}
with the entire paper as context, even the parts with no changes.
Updated cross-references of the form \CppXIV{}[structure.specifications] 
are shown as \CppXref{structure.specifications} without repeating
\removed{2014} every time.

After applying these changes, the editor should reorder all new
\constraints and \mandates elements to match the conventional order.

\vspace{2.5cm}

Thanks to Tomasz Kami≈Ñski and Frank Birbacher for their detailed reviews of R0.
Thanks to Tim Song for reviewing R1.

Changes since R1:
\begin{itemize}
\item Change "signature" to "call signature" in [structure.specifications].
\item Removed "shall" uses in [err.report.async].
\item Replaced \exposid{DECAY_COPY} with \exposid{decay-copy} everywhere
  (and adjusted cross references from [thread.decay.copy] to [expos.only.func]).
\item Restored \expects in [basic.strand.assign] in addition to \constraints{}.
\item Reverted change to make IP address ranges satisfy borrowed view concept.
\item Fixed \textit{Mandates} for \tcode{executor_binder} constructors.
\item Restored ordering between v4 and v6 IP addresses.
\end{itemize}

Changes since R0:
\begin{itemize}
\item All uses of \tcode{decay_t} reviewed and changed to
  \tcode{remove_cvref_t} where appropriate.
\item Changed "signature" to "call signature" in [structure.specification].
\item The second column in Table~\ref{tab:summary.requirements} now uses
  an italicized \textit{ConceptName} for all rows except one.
\item Added \tcode{explicit} default constructor to \tcode{executor_arg_t}.
\item Restored some "shall" requirements on users that should not have been removed.
\item Make IP address ranges satisfy borrowed view concept.
\end{itemize}

Future work:
\begin{itemize}
\item
Replace non-member operators with hidden friends.
LWG would prefer that to be done in a separate proposal to go via LEWG.
\item
Use concepts to replace \newoldconcept{TypeRequirements}.
\item
Make address ranges satisfy range concepts (currently not possible as
their iterators don't satisfy \tcode{std::input_or_output_iterator}).
\item
Try to specify "completion token" as proper type requirements (or a concept),
unless SG4 are replacing that part of the spec.
\item
Consider replacing \exposid{DEDUCED} with an exposition-only alias template,
e.g. \exposid{async-return-type}\tcode{<CompletionToken, Signature>}
or similar.
\end{itemize}

Open questions (probably to be filed as LWG issues):
\begin{itemize}
\item
Clarify intent of \tcode{strand} move constructor and move assignment.
\item
Should \tcode{address_v4} comparisons really use \tcode{to_uint()},
so that whether 1.0.0.4 is less than 2.0.0.3 depends on host endianness?
\end{itemize}


\newpage

%%--------------------------------------------------
%% The table of contents
% \markboth{\contentsname}{}

%% Include table of contents. Do not list "Contents"
%% within it (per ISO request) but do include a
%% bookmark for it in the PDF.
\phantomsection
\pdfbookmark{\contentsname}{toctarget}
\hypertarget{toctarget}{\tableofcontents*}

\setcounter{tocdepth}{5}

%\input{preface}
